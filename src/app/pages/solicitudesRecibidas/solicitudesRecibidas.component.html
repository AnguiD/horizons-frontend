<app-header></app-header>
<div class="container">
  <app-sidebar></app-sidebar>
  <main class="main-content">
    <div class="page-header">
      <h1 class="page-title">Solicitudes Recibidas</h1>
    </div>

    <div class="requests-card">
      <table class="requests-table">
        <thead>
          <tr>
            <th>Empleado</th>
            <th>Tipo de Solicitud</th>
            <th>Fecha Inicio</th>
            <th>Fecha Fin</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let req of solicitudesRecibidas; let idx = index">
            <tr>
              <td>{{ req.empleado }}</td>
              <td>{{ req.tipo }}</td>
              <td>
                {{ req.fechaInicio ? (req.fechaInicio | date : "dd MMM yyyy") : 'Curso:' }}
              </td>
              <td>
                {{ req.fechaFin ? (req.fechaFin | date : "dd MMM yyyy") : req.duracion }}
              </td>
              <td class="actions-cell">
                <button class="btn-accept" (click)="acceptRequest(req.id)">Aceptar</button>
                <button class="btn-reject" (click)="rejectRequest(req.id)">Rechazar</button>
                <button class="btn-chat" (click)="toggleChat(idx)">
                  {{ chatAbierto === idx ? 'Ocultar' : 'Ver Mas...' }}
                </button>
              </td>
            </tr>
            <tr *ngIf="chatAbierto === idx" class="chat-row">
              <td colspan="6" style="padding: 10px;">
                <app-solicitud-chat
                [solicitud]="req"
                [usuarioActual]="usuarioActual"
                (cerrar)="chatAbierto = null"
                ></app-solicitud-chat>
              </td>
            </tr>
          </ng-container>
          <tr *ngIf="solicitudesRecibidas.length === 0">
            <td colspan="6" class="no-requests">No hay solicitudes pendientes</td>
          </tr>
        </tbody>
      </table>
    </div>
  </main>
</div>
<div class="version-info">horizons 1.0.0</div>